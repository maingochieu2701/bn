<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>S·ªï l∆∞u b√∫t - Nh·∫≠t k√Ω B√≠ch Nghi üìñ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      background: url('https://i.imgur.com/xQF6mfW.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Indie Flower', cursive;
      overflow: hidden;
    }
    #flipbook {
      width: 600px;
      height: 400px;
      margin: 60px auto;
    }
    .page {
      background: hsl(320, 93%, 48%);
      padding: 20px;
      font-size: 1.3rem;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      overflow-y: auto;
      position: relative;
    }
    #form-container {
      text-align: center;
      margin-top: 10px;
    }
    input, textarea, button {
      font-family: 'Indie Flower', cursive;
      padding: 8px;
      margin: 4px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #ffb3c1;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #ff94a2;
    }
    .sigblock {
      margin-top: 15px;
    }
    canvas {
      border: 1px solid hsl(202, 100%, 53%);
      border-radius: 4px;
      display: block;
      margin: 8px auto 0 auto;
      background: #ffffff;
    }
    small {
      color: #999;
    }
  
<style>
  #flipbook {
    background: #d60ebf;
    box-shadow: 0 0 0 5px #fce4b3, 0 0 20px rgba(0,0,0,0.2);
    border-radius: 6px;
  }
  .page {
    font-family: 'Patrick Hand', cursive;
    background: repeating-linear-gradient(
      to bottom,
      #fffde7,
      #fffde7 28px,
      #fce4b3 28px,
      #fce4b3 29px
    );
    padding: 25px;
    line-height: 28px;
    box-sizing: border-box;
    border-left: 4px solid #ef9a9a;
  }
</style>

</style>

<style>
  #cover.opening {
    animation: slideCover 1s forwards ease-in-out;
  }
  @keyframes slideCover {
    0% { transform: translateX(0); opacity: 1; }
    100% { transform: translateX(100%) scale(1.1); opacity: 0; }
  }

<style>
  #flipbook {
    background: #fef9e7;
    box-shadow: 0 0 0 5px #fce4b3, 0 0 20px rgba(0,0,0,0.2);
    border-radius: 6px;
  }
  .page {
    font-family: 'Patrick Hand', cursive;
    background: repeating-linear-gradient(
      to bottom,
      #fffde7,
      #fffde7 28px,
      #fce4b3 28px,
      #fce4b3 29px
    );
    padding: 25px;
    line-height: 28px;
    box-sizing: border-box;
    border-left: 4px solid #ef9a9a;
  }
</style>

</style>
</head>
<body>

<audio id="flipSound" src="https://www.soundjay.com/misc/page-turn-8.mp3" preload="auto"></audio>
<audio autoplay loop>
  <source src="lebao.mp3" type="audio/mpeg">
</audio>


<!-- Cover Page -->
<div id="cover" style="position:fixed;inset:0;background:linear-gradient(135deg,#ffecd2,#fcb69f);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;">
  <h1 style="font-size:2.5rem;margin-bottom:1rem;font-family:'Indie Flower',cursive;">üìò S·ªï l∆∞u b√∫t c·ªßa ai?</h1>
  <input id="ownerInput" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n" style="font-family:'Indie Flower';padding:10px;font-size:1.2rem;border-radius:8px;border:1px solid #ccc;margin-bottom:1rem;" />
  <button onclick="startDiary()" style="font-size:1.1rem;padding:10px 20px;border:none;border-radius:8px;background:#ff9a8b;color:white;font-family:'Indie Flower';cursor:pointer;">V√†o s·ªï l∆∞u b√∫t</button>
</div>

<div id="flipbook"></div>

<div id="form-container">
  <input type="text" id="name" placeholder="T√™n b·∫°n" />
  <textarea id="message" placeholder="L·ªùi ch√∫c ho·∫∑c k·ª∑ ni·ªám..." rows="2" cols="30"></textarea><br>
  <canvas id="sigCanvas" width="250" height="60"></canvas><br>
  <button onclick="addPage()">‚úçÔ∏è G·ª≠i l·ªùi ch√∫c</button>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js">
// Trang b√¨a t√™n ch·ªß s·ªï
function startDiary() {
  const name = document.getElementById("ownerInput").value.trim();
  if (!name) return alert("B·∫°n ch∆∞a nh·∫≠p t√™n c·ªßa m√¨nh!");
  localStorage.setItem("diaryOwner", name);
  document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
}

window.addEventListener("load", () => {
  const owner = localStorage.getItem("diaryOwner");
  if (owner) {
    document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
    const welcome = document.createElement("div");
    welcome.className = "page";
    welcome.innerHTML = `üìî ƒê√¢y l√† s·ªï l∆∞u b√∫t c·ªßa <strong>${owner}</strong><br><br>H√£y c√πng vi·∫øt nh·ªØng d√≤ng k·ª∑ ni·ªám th·∫≠t ƒë·∫πp nh√©!`;
    flipbook.prepend(welcome);
  }
});

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4.1.0/turn.min.js">
// Trang b√¨a t√™n ch·ªß s·ªï
function startDiary() {
  const name = document.getElementById("ownerInput").value.trim();
  if (!name) return alert("B·∫°n ch∆∞a nh·∫≠p t√™n c·ªßa m√¨nh!");
  localStorage.setItem("diaryOwner", name);
  document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
}

window.addEventListener("load", () => {
  const owner = localStorage.getItem("diaryOwner");
  if (owner) {
    document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
    const welcome = document.createElement("div");
    welcome.className = "page";
    welcome.innerHTML = `üìî ƒê√¢y l√† s·ªï l∆∞u b√∫t c·ªßa <strong>${owner}</strong><br><br>H√£y c√πng vi·∫øt nh·ªØng d√≤ng k·ª∑ ni·ªám th·∫≠t ƒë·∫πp nh√©!`;
    flipbook.prepend(welcome);
  }
});

</script>
<script>
  const flipbook = document.getElementById('flipbook');
  const flipSound = document.getElementById('flipSound');
  const sigCanvas = document.getElementById('sigCanvas');
  const ctx = sigCanvas.getContext('2d');
  let drawing = false;

  sigCanvas.addEventListener('mousedown', e => {
    drawing = true;
    ctx.beginPath();
    ctx.moveTo(e.offsetX, e.offsetY);
  });
  sigCanvas.addEventListener('mousemove', e => {
    if (drawing) {
      ctx.lineTo(e.offsetX, e.offsetY);
      ctx.stroke();
    }
  });
  sigCanvas.addEventListener('mouseup', () => drawing = false);
  sigCanvas.addEventListener('mouseleave', () => drawing = false);

  // Touch support
  sigCanvas.addEventListener('touchstart', e => {
    e.preventDefault();
    const rect = sigCanvas.getBoundingClientRect();
    ctx.beginPath();
    ctx.moveTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
    drawing = true;
  });
  sigCanvas.addEventListener('touchmove', e => {
    e.preventDefault();
    const rect = sigCanvas.getBoundingClientRect();
    if (drawing) {
      ctx.lineTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
      ctx.stroke();
    }
  });
  sigCanvas.addEventListener('touchend', () => drawing = false);

  let saved = JSON.parse(localStorage.getItem('pages') || '[]');
  let currentPages = [...saved];

  function renderPages() {
    flipbook.innerHTML = '';
    if (currentPages.length === 0) {
      flipbook.innerHTML = '<div class="page">üå∏ Ch√†o m·ª´ng ƒë·∫øn v·ªõi s·ªï l∆∞u b√∫t c·ªßa B√≠ch Nghi!<br><br>H√£y l√† ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë·ªÉ l·∫°i l·ªùi nh·∫Øn nh√©!</div>';
    } else {
      currentPages.forEach((p) => {
        const div = document.createElement('div');
        div.className = 'page';
        div.innerHTML = `<strong>${p.name}</strong>: ${p.msg}<br><small>üïí ${p.time}</small><div class="sigblock"><img src="${p.sig}" width="180"/><br><small>‚úçÔ∏è ${p.name} t·ª± k√Ω</small></div>`;
        flipbook.appendChild(div);
      });
    }
    $('#flipbook').turn({
      width: 600,
      height: 400,
      autoCenter: true,
      gradients: true,
      when: {
        turning: () => flipSound.play()
      }
    });
  }

  function addPage() {
    const name = document.getElementById('name').value.trim();
    const msg = document.getElementById('message').value.trim();
    if (!name || !msg) return alert("ƒêi·ªÅn ƒë·∫ßy ƒë·ªß t√™n v√† l·ªùi ch√∫c!");

    const sigData = sigCanvas.toDataURL();
    const now = new Date();
    const entry = {
      name,
      msg,
      time: now.toLocaleString('vi-VN'),
      sig: sigData
    };

    currentPages.push(entry);
    localStorage.setItem('pages', JSON.stringify(currentPages));
    document.getElementById('message').value = '';
    ctx.clearRect(0, 0, sigCanvas.width, sigCanvas.height);
    renderPages();
  }

  renderPages();

// Trang b√¨a t√™n ch·ªß s·ªï
function startDiary() {
  const name = document.getElementById("ownerInput").value.trim();
  if (!name) return alert("B·∫°n ch∆∞a nh·∫≠p t√™n c·ªßa m√¨nh!");
  localStorage.setItem("diaryOwner", name);
  document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
}

window.addEventListener("load", () => {
  const owner = localStorage.getItem("diaryOwner");
  if (owner) {
    document.getElementById("cover").classList.add("opening"); setTimeout(() => document.getElementById("cover").style.display = "none", 1000);
    const welcome = document.createElement("div");
    welcome.className = "page";
    welcome.innerHTML = `üìî ƒê√¢y l√† s·ªï l∆∞u b√∫t c·ªßa <strong>${owner}</strong><br><br>H√£y c√πng vi·∫øt nh·ªØng d√≤ng k·ª∑ ni·ªám th·∫≠t ƒë·∫πp nh√©!`;
    flipbook.prepend(welcome);
  }
});

</script>
</body>
</html>
